2025-07-01 10:18:41,466 - INFO - === Embedding Script Start ===
2025-07-01 10:18:41,508 - INFO - Use pytorch device_name: mps
2025-07-01 10:18:41,509 - INFO - Load pretrained SentenceTransformer: BAAI/bge-m3
2025-07-01 10:18:44,630 - INFO - Loaded model: BAAI/bge-m3
2025-07-01 10:18:44,687 - ERROR - Error fetching nodes from Neo4j
Traceback (most recent call last):
  File "/Users/alexanderfisher/GitHub/digitai/digitaiCore/embed_bge_m3.py", line 53, in <module>
    nodes = session.execute_read(fetch_nodes)
  File "/Users/alexanderfisher/GitHub/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/work/session.py", line 697, in execute_read
    return self._run_transaction(
           ~~~~~~~~~~~~~~~~~~~~~^
        READ_ACCESS,
        ^^^^^^^^^^^^
    ...<3 lines>...
        kwargs,
        ^^^^^^^
    )
    ^
  File "/Users/alexanderfisher/GitHub/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/work/session.py", line 572, in _run_transaction
    self._open_transaction(
    ~~~~~~~~~~~~~~~~~~~~~~^
        tx_cls=ManagedTransaction,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        api_success_cb=api_success_cb,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/alexanderfisher/GitHub/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/work/session.py", line 441, in _open_transaction
    self._connect(access_mode=access_mode)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alexanderfisher/GitHub/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/work/session.py", line 136, in _connect
    super()._connect(
    ~~~~~~~~~~~~~~~~^
        access_mode, auth=self._config.auth, **acquire_kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/alexanderfisher/GitHub/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/work/workspace.py", line 199, in _connect
    self._connection = self._pool.acquire(**acquire_kwargs_)
                       ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/alexanderfisher/GitHub/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_pool.py", line 662, in acquire
    return self._acquire(
           ~~~~~~~~~~~~~^
        self.address, auth, deadline, liveness_check_timeout
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/alexanderfisher/GitHub/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_pool.py", line 408, in _acquire
    return connection_creator()
  File "/Users/alexanderfisher/GitHub/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_pool.py", line 230, in connection_creator
    connection = self.opener(
        address, auth or self.pool_config.auth, deadline
    )
  File "/Users/alexanderfisher/GitHub/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_pool.py", line 624, in opener
    return Bolt.open(
           ~~~~~~~~~^
        addr,
        ^^^^^
    ...<3 lines>...
        pool_config=pool_config,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/alexanderfisher/GitHub/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_bolt.py", line 430, in open
    connection.hello()
    ~~~~~~~~~~~~~~~~^^
  File "/Users/alexanderfisher/GitHub/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_bolt5.py", line 740, in hello
    self.fetch_all()
    ~~~~~~~~~~~~~~^^
  File "/Users/alexanderfisher/GitHub/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_bolt.py", line 879, in fetch_all
    detail_delta, summary_delta = self.fetch_message()
                                  ~~~~~~~~~~~~~~~~~~^^
  File "/Users/alexanderfisher/GitHub/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_bolt.py", line 864, in fetch_message
    res = self._process_message(tag, fields)
  File "/Users/alexanderfisher/GitHub/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_bolt5.py", line 1208, in _process_message
    response.on_failure(summary_metadata or {})
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alexanderfisher/GitHub/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_common.py", line 295, in on_failure
    raise self._hydrate_error(metadata)
neo4j.exceptions.AuthError: {code: Neo.ClientError.Security.Unauthorized} {message: The client is unauthorized due to authentication failure.}
2025-07-01 10:20:17,204 - INFO - === Embedding Script Start ===
2025-07-01 10:20:17,220 - INFO - Use pytorch device_name: mps
2025-07-01 10:20:17,220 - INFO - Load pretrained SentenceTransformer: BAAI/bge-m3
2025-07-01 10:20:19,846 - INFO - Loaded model: BAAI/bge-m3
2025-07-01 10:20:20,049 - WARNING - Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.FeatureDeprecationWarning} {category: DEPRECATION} {title: This feature is deprecated and will be removed in future versions.} {description: The query used a deprecated function. ('id' has been replaced by 'elementId or an application-generated id')} {position: line: 1, column: 59, offset: 58} for query: 'MATCH (n) WHERE n.text IS NOT NULL RETURN n.text AS text, id(n) AS node_id'
2025-07-01 10:20:20,051 - INFO - Fetched 3324 nodes from Neo4j
2025-07-01 10:21:50,533 - INFO - Successfully embedded batch 0 to 32
2025-07-01 10:21:57,182 - INFO - Successfully embedded batch 32 to 64
2025-07-01 10:21:59,402 - INFO - Successfully embedded batch 64 to 96
2025-07-01 10:22:01,575 - INFO - Successfully embedded batch 96 to 128
2025-07-01 10:22:02,982 - INFO - Successfully embedded batch 128 to 160
2025-07-01 10:22:04,347 - INFO - Successfully embedded batch 160 to 192
2025-07-01 10:22:07,545 - INFO - Successfully embedded batch 192 to 224
2025-07-01 10:22:09,999 - INFO - Successfully embedded batch 224 to 256
2025-07-01 10:22:11,494 - INFO - Successfully embedded batch 256 to 288
2025-07-01 10:22:15,239 - INFO - Successfully embedded batch 288 to 320
2025-07-01 10:22:16,379 - INFO - Successfully embedded batch 320 to 352
2025-07-01 10:22:20,842 - INFO - Successfully embedded batch 352 to 384
2025-07-01 10:22:21,530 - ERROR - Embedding failed for batch 384 to 416: Invalid buffer size: 9.06 GB
2025-07-01 10:22:22,976 - INFO - Successfully embedded batch 416 to 448
2025-07-01 10:22:24,674 - INFO - Successfully embedded batch 448 to 480
2025-07-01 10:22:29,034 - INFO - Successfully embedded batch 480 to 512
2025-07-01 10:22:31,197 - INFO - Successfully embedded batch 512 to 544
2025-07-01 10:22:33,248 - INFO - Successfully embedded batch 544 to 576
2025-07-01 10:22:36,237 - INFO - Successfully embedded batch 576 to 608
2025-07-01 10:22:37,819 - INFO - Successfully embedded batch 608 to 640
2025-07-01 10:22:39,204 - INFO - Successfully embedded batch 640 to 672
2025-07-01 10:22:41,572 - INFO - Successfully embedded batch 672 to 704
2025-07-01 10:22:42,954 - INFO - Successfully embedded batch 704 to 736
2025-07-01 10:22:45,268 - INFO - Successfully embedded batch 736 to 768
2025-07-01 10:22:47,262 - INFO - Successfully embedded batch 768 to 800
2025-07-01 10:22:48,675 - INFO - Successfully embedded batch 800 to 832
2025-07-01 10:22:49,997 - INFO - Successfully embedded batch 832 to 864
2025-07-01 10:22:51,375 - ERROR - Embedding failed for batch 864 to 896: Invalid buffer size: 26.65 GB
2025-07-01 10:22:57,017 - INFO - Successfully embedded batch 896 to 928
2025-07-01 10:22:59,592 - INFO - Successfully embedded batch 928 to 960
2025-07-01 10:23:01,362 - INFO - Successfully embedded batch 960 to 992
2025-07-01 10:23:16,215 - INFO - Successfully embedded batch 992 to 1024
2025-07-01 10:23:21,063 - INFO - Successfully embedded batch 1024 to 1056
2025-07-01 10:23:22,524 - INFO - Successfully embedded batch 1056 to 1088
2025-07-01 10:23:28,053 - INFO - Successfully embedded batch 1088 to 1120
2025-07-01 10:23:29,556 - INFO - Successfully embedded batch 1120 to 1152
2025-07-01 10:23:31,194 - INFO - Successfully embedded batch 1152 to 1184
2025-07-01 10:23:32,772 - INFO - Successfully embedded batch 1184 to 1216
2025-07-01 10:23:34,591 - INFO - Successfully embedded batch 1216 to 1248
2025-07-01 10:23:36,368 - INFO - Successfully embedded batch 1248 to 1280
2025-07-01 10:23:38,510 - INFO - Successfully embedded batch 1280 to 1312
2025-07-01 10:23:40,653 - INFO - Successfully embedded batch 1312 to 1344
2025-07-01 10:23:43,968 - INFO - Successfully embedded batch 1344 to 1376
2025-07-01 10:23:45,743 - INFO - Successfully embedded batch 1376 to 1408
2025-07-01 10:23:46,068 - ERROR - Embedding failed for batch 1408 to 1440: Invalid buffer size: 15.71 GB
2025-07-01 10:23:47,856 - INFO - Successfully embedded batch 1440 to 1472
2025-07-01 10:23:51,872 - INFO - Successfully embedded batch 1472 to 1504
2025-07-01 10:23:55,375 - INFO - Successfully embedded batch 1504 to 1536
2025-07-01 10:23:59,760 - INFO - Successfully embedded batch 1536 to 1568
2025-07-01 10:24:05,039 - INFO - Successfully embedded batch 1568 to 1600
2025-07-01 10:24:08,132 - INFO - Successfully embedded batch 1600 to 1632
2025-07-01 10:24:14,943 - INFO - Successfully embedded batch 1632 to 1664
2025-07-01 10:24:24,330 - INFO - Successfully embedded batch 1664 to 1696
2025-07-01 10:24:34,882 - INFO - Successfully embedded batch 1696 to 1728
2025-07-01 10:24:39,451 - INFO - Successfully embedded batch 1728 to 1760
2025-07-01 10:24:41,395 - INFO - Successfully embedded batch 1760 to 1792
2025-07-01 10:24:43,818 - INFO - Successfully embedded batch 1792 to 1824
2025-07-01 10:24:45,821 - INFO - Successfully embedded batch 1824 to 1856
2025-07-01 10:24:53,667 - INFO - Successfully embedded batch 1856 to 1888
2025-07-01 10:24:56,098 - INFO - Successfully embedded batch 1888 to 1920
2025-07-01 10:24:59,345 - INFO - Successfully embedded batch 1920 to 1952
2025-07-01 10:25:22,689 - INFO - Successfully embedded batch 1952 to 1984
2025-07-01 10:25:32,061 - INFO - Successfully embedded batch 1984 to 2016
2025-07-01 10:25:34,872 - INFO - Successfully embedded batch 2016 to 2048
2025-07-01 10:25:41,166 - ERROR - Embedding failed for batch 2048 to 2080: Invalid buffer size: 8.74 GB
2025-07-01 10:25:46,559 - ERROR - Embedding failed for batch 2080 to 2112: Invalid buffer size: 8.48 GB
2025-07-01 10:25:56,379 - INFO - Successfully embedded batch 2112 to 2144
2025-07-01 10:25:59,782 - INFO - Successfully embedded batch 2144 to 2176
2025-07-01 10:26:11,480 - INFO - Successfully embedded batch 2176 to 2208
2025-07-01 10:26:13,274 - INFO - Successfully embedded batch 2208 to 2240
2025-07-01 10:26:14,946 - INFO - Successfully embedded batch 2240 to 2272
2025-07-01 10:26:16,639 - INFO - Successfully embedded batch 2272 to 2304
2025-07-01 10:32:46,959 - INFO - Successfully embedded batch 2304 to 2336
2025-07-01 10:32:59,147 - INFO - Successfully embedded batch 2336 to 2368
2025-07-01 10:33:04,462 - INFO - Successfully embedded batch 2368 to 2400
2025-07-01 10:37:34,972 - INFO - Successfully embedded batch 2400 to 2432
2025-07-01 10:37:36,527 - INFO - Successfully embedded batch 2432 to 2464
2025-07-01 10:37:39,286 - INFO - Successfully embedded batch 2464 to 2496
2025-07-01 10:37:41,022 - INFO - Successfully embedded batch 2496 to 2528
2025-07-01 10:37:53,540 - INFO - Successfully embedded batch 2528 to 2560
2025-07-01 10:37:55,363 - INFO - Successfully embedded batch 2560 to 2592
2025-07-01 10:37:55,953 - ERROR - Embedding failed for batch 2592 to 2624: Invalid buffer size: 8.87 GB
2025-07-01 10:37:58,713 - INFO - Successfully embedded batch 2624 to 2656
2025-07-01 10:38:02,884 - INFO - Successfully embedded batch 2656 to 2688
2025-07-01 10:38:07,029 - INFO - Successfully embedded batch 2688 to 2720
2025-07-01 10:38:08,291 - INFO - Successfully embedded batch 2720 to 2752
2025-07-01 10:38:09,818 - INFO - Successfully embedded batch 2752 to 2784
2025-07-01 10:38:14,674 - ERROR - Embedding failed for batch 2784 to 2816: MPS backend out of memory (MPS allocated: 15.47 GB, other allocations: 352.09 MB, max allowed: 18.13 GB). Tried to allocate 4.34 GB on private pool. Use PYTORCH_MPS_HIGH_WATERMARK_RATIO=0.0 to disable upper limit for memory allocations (may cause system failure).
2025-07-01 10:38:28,295 - INFO - Successfully embedded batch 2816 to 2848
2025-07-01 10:38:31,134 - INFO - Successfully embedded batch 2848 to 2880
2025-07-01 10:38:34,471 - INFO - Successfully embedded batch 2880 to 2912
2025-07-01 10:38:37,816 - INFO - Successfully embedded batch 2912 to 2944
2025-07-01 10:38:39,559 - INFO - Successfully embedded batch 2944 to 2976
2025-07-01 10:38:41,483 - INFO - Successfully embedded batch 2976 to 3008
2025-07-01 10:38:43,005 - INFO - Successfully embedded batch 3008 to 3040
2025-07-01 10:38:46,675 - INFO - Successfully embedded batch 3040 to 3072
2025-07-01 10:38:48,912 - INFO - Successfully embedded batch 3072 to 3104
2025-07-01 10:38:51,741 - INFO - Successfully embedded batch 3104 to 3136
2025-07-01 10:38:53,393 - INFO - Successfully embedded batch 3136 to 3168
2025-07-01 10:38:55,794 - INFO - Successfully embedded batch 3168 to 3200
2025-07-01 10:38:59,059 - INFO - Successfully embedded batch 3200 to 3232
2025-07-01 10:39:01,536 - INFO - Successfully embedded batch 3232 to 3264
2025-07-01 10:39:02,807 - INFO - Successfully embedded batch 3264 to 3296
2025-07-01 10:39:14,524 - INFO - Successfully embedded batch 3296 to 3324
2025-07-01 10:39:17,147 - INFO - Saved embeddings to /Users/alexanderfisher/GitHub/data/p5/p5NodeEmbeddings.json
2025-07-01 10:39:17,147 - INFO - === Embedding Script End ===
2025-07-01 12:02:57,337 - INFO - === Embedding Script Start ===
2025-07-01 12:02:57,356 - INFO - Use pytorch device_name: mps
2025-07-01 12:02:57,356 - INFO - Load pretrained SentenceTransformer: BAAI/bge-m3
2025-07-01 12:03:00,419 - INFO - Loaded model: BAAI/bge-m3
2025-07-01 12:03:01,066 - WARNING - Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.FeatureDeprecationWarning} {category: DEPRECATION} {title: This feature is deprecated and will be removed in future versions.} {description: The query used a deprecated function. ('id' has been replaced by 'elementId or an application-generated id')} {position: line: 1, column: 59, offset: 58} for query: 'MATCH (n) WHERE n.text IS NOT NULL RETURN n.text AS text, id(n) AS node_id'
2025-07-01 12:03:01,068 - INFO - Fetched 3324 nodes from Neo4j
2025-07-01 12:05:16,444 - INFO - === Embedding Script Start ===
2025-07-01 12:05:16,474 - INFO - Use pytorch device_name: mps
2025-07-01 12:05:16,474 - INFO - Load pretrained SentenceTransformer: BAAI/bge-m3
2025-07-01 12:05:19,048 - INFO - Loaded model: BAAI/bge-m3
2025-07-01 12:05:19,186 - WARNING - Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.FeatureDeprecationWarning} {category: DEPRECATION} {title: This feature is deprecated and will be removed in future versions.} {description: The query used a deprecated function. ('id' has been replaced by 'elementId or an application-generated id')} {position: line: 1, column: 59, offset: 58} for query: 'MATCH (n) WHERE n.text IS NOT NULL RETURN n.text AS text, id(n) AS node_id'
2025-07-01 12:05:19,188 - INFO - Fetched 3324 nodes from Neo4j
2025-07-02 16:30:32,077 - INFO - === Embedding Script Start ===
2025-07-02 16:30:32,125 - INFO - Use pytorch device_name: mps
2025-07-02 16:30:32,129 - INFO - Load pretrained SentenceTransformer: BAAI/bge-m3
2025-07-02 16:30:58,155 - INFO - Loaded model: BAAI/bge-m3
2025-07-02 16:30:58,161 - ERROR - Error fetching nodes from Neo4j
Traceback (most recent call last):
  File "/Users/digitopenlab/github/digitai/digitaiCore/embed_bge_m3.py", line 53, in <module>
    nodes = session.execute_read(fetch_nodes)
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/work/session.py", line 697, in execute_read
    return self._run_transaction(
           ~~~~~~~~~~~~~~~~~~~~~^
        READ_ACCESS,
        ^^^^^^^^^^^^
    ...<3 lines>...
        kwargs,
        ^^^^^^^
    )
    ^
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/work/session.py", line 572, in _run_transaction
    self._open_transaction(
    ~~~~~~~~~~~~~~~~~~~~~~^
        tx_cls=ManagedTransaction,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        api_success_cb=api_success_cb,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/work/session.py", line 441, in _open_transaction
    self._connect(access_mode=access_mode)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/work/session.py", line 136, in _connect
    super()._connect(
    ~~~~~~~~~~~~~~~~^
        access_mode, auth=self._config.auth, **acquire_kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/work/workspace.py", line 199, in _connect
    self._connection = self._pool.acquire(**acquire_kwargs_)
                       ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_pool.py", line 662, in acquire
    return self._acquire(
           ~~~~~~~~~~~~~^
        self.address, auth, deadline, liveness_check_timeout
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_pool.py", line 408, in _acquire
    return connection_creator()
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_pool.py", line 230, in connection_creator
    connection = self.opener(
        address, auth or self.pool_config.auth, deadline
    )
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_pool.py", line 624, in opener
    return Bolt.open(
           ~~~~~~~~~^
        addr,
        ^^^^^
    ...<3 lines>...
        pool_config=pool_config,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_bolt.py", line 430, in open
    connection.hello()
    ~~~~~~~~~~~~~~~~^^
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_bolt5.py", line 740, in hello
    self.fetch_all()
    ~~~~~~~~~~~~~~^^
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_bolt.py", line 879, in fetch_all
    detail_delta, summary_delta = self.fetch_message()
                                  ~~~~~~~~~~~~~~~~~~^^
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_bolt.py", line 864, in fetch_message
    res = self._process_message(tag, fields)
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_bolt5.py", line 1208, in _process_message
    response.on_failure(summary_metadata or {})
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_common.py", line 295, in on_failure
    raise self._hydrate_error(metadata)
neo4j.exceptions.AuthError: {code: Neo.ClientError.Security.Unauthorized} {message: The client is unauthorized due to authentication failure.}
2025-07-02 16:33:55,451 - INFO - === Embedding Script Start ===
2025-07-02 16:33:55,584 - INFO - Use pytorch device_name: mps
2025-07-02 16:33:55,585 - INFO - Load pretrained SentenceTransformer: BAAI/bge-m3
2025-07-02 16:34:02,140 - INFO - Loaded model: BAAI/bge-m3
2025-07-02 16:34:02,144 - ERROR - Error fetching nodes from Neo4j
Traceback (most recent call last):
  File "/Users/digitopenlab/github/digitai/digitaiCore/embed_bge_m3.py", line 53, in <module>
    nodes = session.execute_read(fetch_nodes)
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/work/session.py", line 697, in execute_read
    return self._run_transaction(
           ~~~~~~~~~~~~~~~~~~~~~^
        READ_ACCESS,
        ^^^^^^^^^^^^
    ...<3 lines>...
        kwargs,
        ^^^^^^^
    )
    ^
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/work/session.py", line 572, in _run_transaction
    self._open_transaction(
    ~~~~~~~~~~~~~~~~~~~~~~^
        tx_cls=ManagedTransaction,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        api_success_cb=api_success_cb,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/work/session.py", line 441, in _open_transaction
    self._connect(access_mode=access_mode)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/work/session.py", line 136, in _connect
    super()._connect(
    ~~~~~~~~~~~~~~~~^
        access_mode, auth=self._config.auth, **acquire_kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/work/workspace.py", line 199, in _connect
    self._connection = self._pool.acquire(**acquire_kwargs_)
                       ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_pool.py", line 662, in acquire
    return self._acquire(
           ~~~~~~~~~~~~~^
        self.address, auth, deadline, liveness_check_timeout
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_pool.py", line 408, in _acquire
    return connection_creator()
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_pool.py", line 230, in connection_creator
    connection = self.opener(
        address, auth or self.pool_config.auth, deadline
    )
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_pool.py", line 624, in opener
    return Bolt.open(
           ~~~~~~~~~^
        addr,
        ^^^^^
    ...<3 lines>...
        pool_config=pool_config,
        ^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_bolt.py", line 430, in open
    connection.hello()
    ~~~~~~~~~~~~~~~~^^
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_bolt5.py", line 740, in hello
    self.fetch_all()
    ~~~~~~~~~~~~~~^^
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_bolt.py", line 879, in fetch_all
    detail_delta, summary_delta = self.fetch_message()
                                  ~~~~~~~~~~~~~~~~~~^^
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_bolt.py", line 864, in fetch_message
    res = self._process_message(tag, fields)
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_bolt5.py", line 1208, in _process_message
    response.on_failure(summary_metadata or {})
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/digitopenlab/github/digitai/.venv/lib/python3.13/site-packages/neo4j/_sync/io/_common.py", line 295, in on_failure
    raise self._hydrate_error(metadata)
neo4j.exceptions.AuthError: {code: Neo.ClientError.Security.Unauthorized} {message: The client is unauthorized due to authentication failure.}
2025-07-02 16:51:11,143 - INFO - === Embedding Script Start ===
2025-07-02 16:51:11,276 - INFO - Use pytorch device_name: mps
2025-07-02 16:51:11,276 - INFO - Load pretrained SentenceTransformer: BAAI/bge-m3
2025-07-02 16:51:18,702 - INFO - Loaded model: BAAI/bge-m3
2025-07-02 16:51:18,772 - WARNING - Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.FeatureDeprecationWarning} {category: DEPRECATION} {title: This feature is deprecated and will be removed in future versions.} {description: The query used a deprecated function. ('id' has been replaced by 'elementId or consider using an application-generated id')} {position: line: 1, column: 59, offset: 58} for query: 'MATCH (n) WHERE n.text IS NOT NULL RETURN n.text AS text, id(n) AS node_id'
2025-07-02 16:51:18,772 - INFO - Fetched 3368 nodes from Neo4j
2025-07-02 16:51:20,613 - ERROR - Embedding failed for batch 0 to 128: Invalid buffer size: 106.60 GB
2025-07-02 16:51:27,300 - INFO - Successfully embedded batch 128 to 256
2025-07-02 16:51:31,385 - INFO - Successfully embedded batch 256 to 384
2025-07-02 16:51:34,762 - INFO - Successfully embedded batch 384 to 512
2025-07-02 16:51:40,595 - INFO - Successfully embedded batch 512 to 640
2025-07-02 16:51:54,833 - INFO - Successfully embedded batch 640 to 768
2025-07-02 16:54:59,453 - INFO - Successfully embedded batch 768 to 896
2025-07-02 16:55:00,288 - ERROR - Embedding failed for batch 896 to 1024: masked_fill not supported for tensors of more than 2**32 elements
2025-07-02 16:55:07,353 - INFO - Successfully embedded batch 1024 to 1152
2025-07-02 16:55:13,697 - INFO - Successfully embedded batch 1152 to 1280
2025-07-02 16:55:21,357 - INFO - Successfully embedded batch 1280 to 1408
2025-07-02 16:55:25,741 - INFO - Successfully embedded batch 1408 to 1536
2025-07-02 16:55:38,976 - INFO - Successfully embedded batch 1536 to 1664
2025-07-02 16:55:42,696 - INFO - Successfully embedded batch 1664 to 1792
2025-07-02 16:55:55,974 - ERROR - Embedding failed for batch 1792 to 1920: MPS backend out of memory (MPS allocated: 51.43 GB, other allocations: 125.69 GB, max allowed: 163.20 GB). Tried to allocate 1.40 GB on private pool. Use PYTORCH_MPS_HIGH_WATERMARK_RATIO=0.0 to disable upper limit for memory allocations (may cause system failure).
2025-07-02 16:55:59,655 - INFO - Successfully embedded batch 1920 to 2048
2025-07-02 16:59:31,116 - INFO - Successfully embedded batch 2048 to 2176
2025-07-02 16:59:43,455 - INFO - Successfully embedded batch 2176 to 2304
2025-07-02 16:59:47,193 - INFO - Successfully embedded batch 2304 to 2432
2025-07-02 16:59:50,413 - INFO - Successfully embedded batch 2432 to 2560
2025-07-02 17:00:02,142 - INFO - Successfully embedded batch 2560 to 2688
2025-07-02 17:09:12,538 - INFO - Successfully embedded batch 2688 to 2816
2025-07-02 17:09:19,479 - INFO - Successfully embedded batch 2816 to 2944
2025-07-02 17:09:26,022 - INFO - Successfully embedded batch 2944 to 3072
2025-07-02 17:12:02,606 - INFO - Successfully embedded batch 3072 to 3200
2025-07-02 17:12:08,741 - INFO - Successfully embedded batch 3200 to 3328
2025-07-02 17:12:09,647 - INFO - Successfully embedded batch 3328 to 3368
2025-07-02 17:12:09,661 - INFO - Saved embeddings to /Users/digitopenlab/github/data/p5/neo4jNodeEmbeddings.json
2025-07-02 17:12:09,661 - INFO - === Embedding Script End ===
